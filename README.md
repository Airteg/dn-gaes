# –û–ø–∏—Å –≥—ñ–ª–∫–∏ –¥–ª—è –º–∞–π–±—É—Ç–Ω—å–æ–≥–æ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞

–¶–µ–π –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—É—î —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≥—ñ–ª–∫–∏, –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—é –∫–æ–¥—É, –æ—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó —Ç–∞ —Ç—Ä—É–¥–Ω–æ—â—ñ, –∑ —è–∫–∏–º–∏ —è –∑—ñ—Ç–∫–Ω—É–≤—Å—è –ø—ñ–¥ —á–∞—Å —Ä–æ–∑—Ä–æ–±–∫–∏. –í—ñ–Ω —Å—Ç–≤–æ—Ä–µ–Ω–∏–π –¥–ª—è –º–∞–π–±—É—Ç–Ω—å–æ–≥–æ –º–µ–Ω–µ –∞–±–æ —ñ–Ω—à–æ–≥–æ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞, —â–æ–± —à–≤–∏–¥–∫–æ —Ä–æ–∑—ñ–±—Ä–∞—Ç–∏—Å—è –≤ –ø—Ä–æ—î–∫—Ç—ñ.

---

## 1. –û–≥–ª—è–¥ –ø—Ä–æ—î–∫—Ç—É

–ì—ñ–ª–∫–∞ —Ä–µ–∞–ª—ñ–∑—É—î —Å—Ç–æ—Ä—ñ–Ω–∫—É –∫–µ—Ä—É–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏ –¥–ª—è –∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—ñ (`/admin/users`). –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∏ –º–æ–∂—É—Ç—å –ø–µ—Ä–µ–≥–ª—è–¥–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ —ó—Ö –¥–∞–Ω—ñ —Ç–∞ –ø–æ–∑–Ω–∞—á–∞—Ç–∏ —è–∫ –≤–∏–¥–∞–ª–µ–Ω–∏—Ö. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Å–µ—Ä–≤–µ—Ä–Ω–∏–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ (SSR) –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —ñ –∫–ª—ñ—î–Ω—Ç—Å—å–∫—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –¥–ª—è —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ (—Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è, –ø–∞–≥—ñ–Ω–∞—Ü—ñ—è, —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è).

### –û—Å–Ω–æ–≤–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏

- **–°—Ç–æ—Ä—ñ–Ω–∫–∞**: `src/app/admin/users/page.jsx` ‚Äî –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —ñ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ.
- **–¢–∞–±–ª–∏—Ü—è**: `src/components/admin/users/UsersTable.jsx` ‚Äî –∫–ª—ñ—î–Ω—Ç—Å—å–∫–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —ñ–∑ `@tanstack/react-table` –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –¥–∞–Ω–∏–º–∏.
- **API**: `src/app/api/admin/users/[id]/route.js` ‚Äî –µ–Ω–¥–ø–æ—ó–Ω—Ç–∏ –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è (`PUT`) —Ç–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è (`DELETE`).
- **–£—Ç–∏–ª—ñ—Ç–∏**: `src/utils/db/users.js` ‚Äî —Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ MongoDB.

---

## 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

–ü—Ä–æ—î–∫—Ç –ø–æ–±—É–¥–æ–≤–∞–Ω–∏–π –Ω–∞ **Next.js (App Router)** —ñ–∑ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—î—é —á–µ—Ä–µ–∑ `next-auth` —ñ –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö **MongoDB**.

### –ö–ª—é—á–æ–≤—ñ —Ñ–∞–π–ª–∏

- **–°—Ç–æ—Ä—ñ–Ω–∫–∏**:
  - `src/app/admin/users/page.jsx` ‚Äî —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ (SSR).
  - `src/app/api/admin/users/[id]/route.js` ‚Äî API –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è/–≤–∏–¥–∞–ª–µ–Ω–Ω—è.
- **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏**:
  - `src/components/admin/users/UsersTable.jsx` ‚Äî —Ç–∞–±–ª–∏—Ü—è –∑ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—é.
- **–£—Ç–∏–ª—ñ—Ç–∏**:
  - `src/utils/db.js` ‚Äî –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ MongoDB.
  - `src/utils/db/users.js` ‚Äî –º–µ—Ç–æ–¥–∏ –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏.
  - `src/auth.js` ‚Äî –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è `next-auth`.
  - `src/middleware.js` ‚Äî –∑–∞—Ö–∏—Å—Ç –º–∞—Ä—à—Ä—É—Ç—ñ–≤.
- **–ú–æ–¥–µ–ª—ñ**:
  - `src/models/User.js` ‚Äî —Å—Ö–µ–º–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.

### –í–∑–∞—î–º–æ–¥—ñ—è

1. –°—Ç–æ—Ä—ñ–Ω–∫–∞ `/admin/users` –≤–∏–∫–ª–∏–∫–∞—î `getUsers` —ñ–∑ `src/utils/db/users.js` —ñ –ø–µ—Ä–µ–¥–∞—î –¥–∞–Ω—ñ –≤ `UsersTable`.
2. `UsersTable` –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î —Ç–∞–±–ª–∏—Ü—é, –ø—ñ–¥—Ç—Ä–∏–º—É—î —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—é, –ø–∞–≥—ñ–Ω–∞—Ü—ñ—é —Ç–∞ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ API-–∑–∞–ø–∏—Ç–∏.

---

## 3. –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –Ω–æ–≤–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ `next-auth` —ñ–∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é Google —ñ Credentials (email/–ø–∞—Ä–æ–ª—å).

### –î–µ —à—É–∫–∞—Ç–∏ –∫–æ–¥

- **–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è**: `src/auth.js` ‚Äî –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ñ–≤ —ñ —Å–µ—Å—ñ–π.
- **–°—Ç–æ—Ä—ñ–Ω–∫–∞**: `src/app/auth/signin/page.jsx` ‚Äî UI –¥–ª—è –≤—Ö–æ–¥—É/—Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó.
- **–õ–æ–≥—ñ–∫–∞**: –£ `src/auth.js` callback `signIn` –æ–±—Ä–æ–±–ª—è—î —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø—Ä–∏ –≤—Ö–æ–¥—ñ —á–µ—Ä–µ–∑ Google).

### –Ø–∫ –ø—Ä–∞—Ü—é—î

- **Credentials**: –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–≤–æ–¥–∏—Ç—å email/–ø–∞—Ä–æ–ª—å, `next-auth` –ø–µ—Ä–µ–≤—ñ—Ä—è—î —ó—Ö.
- **Google**: –ü—Ä–∏ –ø–µ—Ä—à–æ–º—É –≤—Ö–æ–¥—ñ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –∑–∞–ø–∏—Å —É –ë–î (—è–∫—â–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ).

---

## 4. –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ MongoDB –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ –≤ `src/utils/db.js`:

```javascript
import { MongoClient } from "mongodb";

const uri = process.env.MONGODB_URI;
let client;
let clientPromise;

if (process.env.NODE_ENV === "development") {
  if (!global._mongoClientPromise) {
    client = new MongoClient(uri);
    global._mongoClientPromise = client.connect();
  }
  clientPromise = global._mongoClientPromise;
} else {
  client = new MongoClient(uri);
  clientPromise = client.connect();
}

export default clientPromise;
```

- –£ `development` –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∫–µ—à—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ `global`.
- –ú–µ—Ç–æ–¥–∏ –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏ (–æ—Ç—Ä–∏–º–∞–Ω–Ω—è, –æ–Ω–æ–≤–ª–µ–Ω–Ω—è) ‚Äî —É `src/utils/db/users.js`.

---

## 5. –ë–ª–æ–∫—É–≤–∞–Ω–Ω—è URL —ñ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è

–ê–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ `next-auth`, –∞ –º–∞—Ä—à—Ä—É—Ç–∏ –∑–∞—Ö–∏—â–µ–Ω—ñ —á–µ—Ä–µ–∑ middleware.

### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

- **–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è**: `src/auth.js` ‚Äî –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∏, —Å–µ—Å—ñ—ó, callbacks.
- **Middleware**: `src/middleware.js` ‚Äî –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–ª–µ–π –¥–ª—è `/admin/*`.

### –Ø–∫ –ø—Ä–∞—Ü—é—î –∑–∞—Ö–∏—Å—Ç

- Middleware –ø–µ—Ä–µ–≤—ñ—Ä—è—î —Ç–æ–∫–µ–Ω —ñ —Ä–æ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.
- –Ø–∫—â–æ —Ä–æ–ª—å –Ω–µ `admin` –∞–±–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–µ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î –Ω–∞ `/login`.
- –î–æ–¥–∞—Ç–∫–æ–≤–∞ —Å–µ—Ä–≤–µ—Ä–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤ `page.jsx`:

  ```jsx
  if (!session?.user || session.user.role !== "admin") {
    redirect("/login");
  }
  ```

---

## 6. –¢—Ä—É–¥–Ω–æ—â—ñ —Ç–∞ —ó—Ö –≤–∏—Ä—ñ—à–µ–Ω–Ω—è

–ü—ñ–¥ —á–∞—Å —Ä–æ–∑—Ä–æ–±–∫–∏ –≤–∏–Ω–∏–∫–ª–∏ —Ç–∞–∫—ñ –ø—Ä–æ–±–ª–µ–º–∏:

### –ü—Ä–æ–±–ª–µ–º–∞ –∑ `searchParams` —ñ `params`

- –£ Next.js 15.2.3 —Ü—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –ø—Ä–æ–º—ñ—Å–∞–º–∏.
- **–í–∏—Ä—ñ—à–µ–Ω–Ω—è**: –î–æ–¥–∞–Ω–æ `await` —É `page.jsx` —ñ `route.js`.

### HTML –∑–∞–º—ñ—Å—Ç—å JSON —É API

- –ï–Ω–¥–ø–æ—ó–Ω—Ç –±—É–≤ —É `src/app/...` –∑–∞–º—ñ—Å—Ç—å `src/app/api/...`.
- **–í–∏—Ä—ñ—à–µ–Ω–Ω—è**: –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—É –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é.

### –ü–æ—Ä–æ–∂–Ω—î `name` –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ

- –ü–æ–ª–µ `name` –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É–≤–∞–ª–æ—Å—è –ø–æ—Ä–æ–∂–Ω—ñ–º —Ä—è–¥–∫–æ–º.
- **–í–∏—Ä—ñ—à–µ–Ω–Ω—è**: –î–æ–¥–∞–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –≤ `handleSave` —ñ `route.js`.

### –ü—Ä–æ–±–ª–µ–º–∏ –∑ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—î—é

- Cookie (`authjs.session-token`) –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω–æ —á–∏—Ç–∞–ª–∏—Å—è –≤ middleware.
- **–í–∏—Ä—ñ—à–µ–Ω–Ω—è**: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –¥–∏–Ω–∞–º—ñ—á–Ω–µ —ñ–º‚Äô—è cookie –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ `NODE_ENV`.

---

## 7. –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –ó–∞–ø—É—Å–∫

1. –í—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ: `npm install`.
2. –ó–∞–ø—É—Å—Ç–∏: `npm run dev`.
3. –ü–µ—Ä–µ–π–¥–∏ –Ω–∞ `http://localhost:3000/admin/users` (–∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫—É–π—Å—è —è–∫ `admin`).

### –†–æ–±–æ—Ç–∞ –∑ —Ç–∞–±–ª–∏—Ü–µ—é

- –§—ñ–ª—å—Ç—Ä—É–π –∑–∞ —ñ–º‚Äô—è–º/email.
- –ü–µ—Ä–µ–º–∏–∫–∞–π —Å—Ç–æ—Ä—ñ–Ω–∫–∏.
- –†–µ–¥–∞–≥—É–π —ñ–Ω–ª–∞–π–Ω (—ñ–º‚Äô—è, —Ä–æ–ª—å, —Å—Ç–∞—Ç—É—Å).
- –í–∏–¥–∞–ª—è–π —á–µ—Ä–µ–∑ üóëÔ∏è.

### API

- `PUT /api/admin/users/[id]` ‚Äî –æ–Ω–æ–≤–ª–µ–Ω–Ω—è.
- `DELETE /api/admin/users/[id]` ‚Äî –ø–æ–∑–Ω–∞—á–µ–Ω–Ω—è —è–∫ –≤–∏–¥–∞–ª–µ–Ω–æ–≥–æ.

### –ù–∞ —â–æ –∑–≤–µ—Ä–Ω—É—Ç–∏ —É–≤–∞–≥—É

- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ñ—Å—Ç—å**: –ó–∞–≤–∂–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π `await` –¥–ª—è `searchParams` —ñ `params`.
- **API**: –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Å—è, —â–æ –µ–Ω–¥–ø–æ—ó–Ω—Ç–∏ –≤ `src/app/api/...`.
- **–õ–æ–≥–∏**: –ü—Ä–∏–±–µ—Ä–∏ `console.log` –ø–µ—Ä–µ–¥ –º–µ—Ä–¥–∂–µ–º.

---

## 8. –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏

- –î–æ–¥–∞—Ç–∏ —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –∫–æ–ª–æ–Ω–æ–∫ —É —Ç–∞–±–ª–∏—Ü—ñ.
- –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –∫–µ—à—É–≤–∞–Ω–Ω—è —Å–µ—Å—ñ–π (Redis/Vercel Edge Config).
- –ü–æ–∫—Ä–∞—â–∏—Ç–∏ —Å—Ç–∏–ª—ñ —Ç–∞–±–ª–∏—Ü—ñ (TailwindCSS).
- –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∫—Ä–∞–π–æ–≤—ñ –≤–∏–ø–∞–¥–∫–∏ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è/–≤–∏–¥–∞–ª–µ–Ω–Ω—è.

---

–¶–µ–π –æ–ø–∏—Å –¥–æ–ø–æ–º–æ–∂–µ —à–≤–∏–¥–∫–æ —É–≤—ñ–π—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç —ñ –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ —Ä–æ–±–æ—Ç—É –Ω–∞–¥ –≥—ñ–ª–∫–æ—é. –Ø–∫—â–æ —â–æ—Å—å –Ω–µ–∑—Ä–æ–∑—É–º—ñ–ª–æ, –∑–≤–µ—Ä—Ç–∞–π—Å—è –¥–æ –∫–æ–¥—É –∞–±–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó Next.js/`next-auth`.