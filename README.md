‚úÖ **–Ø–∫ –≤—ñ–¥—Å—Ç–µ–∂–∏—Ç–∏ –ø—Ä–æ—Ü–µ—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó `signIn("google")` —É NextAuth.js?**  

üìå **–ú–∏ –∫—Ä–æ–∫ –∑–∞ –∫—Ä–æ–∫–æ–º –ø–µ—Ä–µ–≤—ñ—Ä–∏–º–æ, —â–æ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –ø—ñ–¥ —á–∞—Å –≤—Ö–æ–¥—É**:  
1Ô∏è‚É£ –í–∏–∫–ª–∏–∫ `signIn("google")` –Ω–∞ –∫–ª—ñ—î–Ω—Ç—ñ.  
2Ô∏è‚É£ –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∞ OAuth.  
3Ô∏è‚É£ –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—é Google.  
4Ô∏è‚É£ –°—Ç–≤–æ—Ä–µ–Ω–Ω—è/–æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ MongoDB.  
5Ô∏è‚É£ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ç–æ–∫–µ–Ω–∞ —Å–µ—Å—ñ—ó.  
6Ô∏è‚É£ –í–∏–∫–æ–Ω–∞–Ω–Ω—è `callbacks.jwt` —Ç–∞ `callbacks.session`.  

---

## **1Ô∏è‚É£ –õ–æ–≥—É–≤–∞–Ω–Ω—è –∫–ª—ñ—î–Ω—Ç—Å—å–∫–æ–≥–æ `signIn`**  

üìÇ **–§–∞–π–ª: `src/app/login/page.jsx`** (–∞–±–æ –¥–µ –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è `signIn`)  
```javascript
import { signIn } from "next-auth/react";

const handleGoogleLogin = async () => {
  console.log("üìå –í—Ö—ñ–¥ —á–µ—Ä–µ–∑ Google —ñ–Ω—ñ—Ü—ñ–π–æ–≤–∞–Ω–æ...");
  const result = await signIn("google", { callbackUrl: "/dashboard" });

  if (result?.error) {
    console.error("‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—Ö–æ–¥—É:", result.error);
  } else {
    console.log("‚úÖ –í—Ö—ñ–¥ —á–µ—Ä–µ–∑ Google —É—Å–ø—ñ—à–Ω–∏–π!");
  }
};
```
üîπ **–©–æ –º–∏ –±–∞—á–∏–º–æ –≤ –∫–æ–Ω—Å–æ–ª—ñ?**  
- `"üìå –í—Ö—ñ–¥ —á–µ—Ä–µ–∑ Google —ñ–Ω—ñ—Ü—ñ–π–æ–≤–∞–Ω–æ..."` –ø–µ—Ä–µ–¥ —Ç–∏–º, —è–∫ –≤—ñ–¥–±—É–¥–µ—Ç—å—Å—è —Ä–µ–¥–∏—Ä–µ–∫—Ç.  
- –Ø–∫—â–æ —î –ø–æ–º–∏–ª–∫–∞ ‚Üí `"‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—Ö–æ–¥—É:"`.  
- –Ø–∫—â–æ –≤—Ö—ñ–¥ —É—Å–ø—ñ—à–Ω–∏–π ‚Üí `"‚úÖ –í—Ö—ñ–¥ —á–µ—Ä–µ–∑ Google —É—Å–ø—ñ—à–Ω–∏–π!"`.  

---

## **2Ô∏è‚É£ –õ–æ–≥—É–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—É –¥–æ `/api/auth/callback/google`**  
üìÇ **–§–∞–π–ª `src/app/api/auth/[...nextauth]/route.js`**  
```javascript
callbacks: {
  async signIn({ user, account, profile }) {
    console.log("üìå –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –∞–≤—Ç–æ—Ä–∏–∑—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ Google:", profile);
    return true; // –î–æ–∑–≤–æ–ª—è—î–º–æ –≤—Ö—ñ–¥
  },

  async jwt({ token, user, account, profile }) {
    console.log("üìå –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è JWT:", { token, user, account, profile });

    if (user) {
      token.id = user.id;
      token.role = user.role || "user";
      token.status = user.status || "pending";
    }
    return token;
  },

  async session({ session, token }) {
    console.log("üìå –§–æ—Ä–º—É–≤–∞–Ω–Ω—è —Å–µ—Å—ñ—ó:", { session, token });

    session.user.id = token.id;
    session.user.role = token.role;
    session.user.status = token.status;

    return session;
  },
}
```
üîπ **–©–æ –º–∏ –±–∞—á–∏–º–æ –≤ —Å–µ—Ä–≤–µ—Ä–Ω—ñ–π –∫–æ–Ω—Å–æ–ª—ñ?**  
1Ô∏è‚É£ `"üìå –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –∞–≤—Ç–æ—Ä–∏–∑—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ Google:"` ‚Äì –æ—Ç—Ä–∏–º–∞—î–º–æ –≤–µ—Å—å –ø—Ä–æ—Ñ—ñ–ª—å –∑ Google.  
2Ô∏è‚É£ `"üìå –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è JWT:"` ‚Äì –ø–µ—Ä–µ–≤—ñ—Ä–∏–º–æ, —è–∫ NextAuth –∑–±–µ—Ä—ñ–≥–∞—î —Ç–æ–∫–µ–Ω.  
3Ô∏è‚É£ `"üìå –§–æ—Ä–º—É–≤–∞–Ω–Ω—è —Å–µ—Å—ñ—ó:"` ‚Äì —á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è `session.user.role` —ñ `session.user.status`.  

---

## **3Ô∏è‚É£ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ MongoDB –ø—ñ—Å–ª—è –≤—Ö–æ–¥—É**  
üìå –í–∏–∫–æ–Ω–∞–π –∫–æ–º–∞–Ω–¥—É —É —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ (MongoDB shell –∞–±–æ GUI, —è–∫ MongoDB Compass):  
```sh
db.users.find().pretty()
```
üîπ **–ü–µ—Ä–µ–∫–æ–Ω–∞—î–º–æ—Å—è, —â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ —Å—Ç–≤–æ—Ä—é—é—Ç—å—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ, —ñ —â–æ —É –Ω–∏—Ö —î `role` —Ç–∞ `status`.**  

---

## **‚úÖ –î–∞–ª—ñ: –¢–µ—Å—Ç—É—î–º–æ!**
1Ô∏è‚É£ **–î–æ–¥–∞—î–º–æ `console.log` —É `signIn()`, `signIn` callback, `jwt` —Ç–∞ `session`.**  
2Ô∏è‚É£ **–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—î–º–æ —Å–µ—Ä–≤–µ—Ä:**  
   ```sh
   pnpm run dev
   ```
3Ô∏è‚É£ **–í—Ö–æ–¥–∏–º–æ —á–µ—Ä–µ–∑ Google.**  
4Ô∏è‚É£ **–ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ —Ç–∞ —Å–µ—Ä–≤–µ—Ä–Ω—ñ –ª–æ–≥–∏.**  

üî• –î–æ–º–æ–≤–∏–ª–∏—Å—å! –¢—Ä–∏–º–∞—î—à ‚Äî **–ü—Ä–∞–∫—Ç–∏—á–Ω–∏–π —Å–ø–∏—Å–æ–∫ –ø—Ä–∞–≤–∏–ª –¥–ª—è —Å—Ç–∞–±—ñ–ª—å–Ω–æ—ó —Ä–æ–±–æ—Ç–∏ –∑ Next.js 13‚Äì15 (App Router)**. –¶–µ –Ω–µ –∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó ‚Äî —Ü–µ –∑ —Ä–µ–∞–ª—å–Ω–∏—Ö –±–æ—ó–≤:

---

## ‚úÖ 1. `"use server"` ‚Äî **—Ç—ñ–ª—å–∫–∏ –¥–ª—è server actions**
- –ù–µ –ø–∏—à–∏ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö, —è–∫—ñ –ø–æ–≤–µ—Ä—Ç–∞—é—Ç—å JSX
- –ú–∞—î –±—É—Ç–∏ **–≤ –æ–∫—Ä–µ–º—ñ–π —Ñ—É–Ω–∫—Ü—ñ—ó**, —â–æ –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è —á–µ—Ä–µ–∑ `action`, `form action`, `startTransition`, —Ç–æ—â–æ
```ts
// OK ‚Äî server action
"use server";
export async function updateUser(data) { ... }

// ‚ùå –ù–µ —Ä–æ–±–∏ —Ç–∞–∫:
"use server";
export default function Page() { return <div />; }
```

---

## ‚úÖ 2. –°–µ—Ä–≤–µ—Ä–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –Ω–µ –ø–æ—Ç—Ä–µ–±—É—é—Ç—å `"use server"`
- –£—Å—ñ `page.tsx`, `layout.tsx`, —Å–µ—Ä–≤–µ—Ä–Ω—ñ `component.tsx` ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ

---

## ‚úÖ 3. `auth()` (next-auth) –≤–∏–∫–ª–∏–∫–∞—î–º–æ **—Ç—ñ–ª—å–∫–∏**:
- —É —Å–µ—Ä–≤–µ—Ä–Ω–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
- —É server actions (`"use server"`)
- ‚ùå **–ù–µ –≤ –∫–ª—ñ—î–Ω—Ç—Å—å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö!**

---

## ‚úÖ 4. –ù–µ —ñ–º–ø–æ—Ä—Ç—É–π `db` —É `middleware.js`
- `middleware` –ø—Ä–∞—Ü—é—î –≤ **Edge Runtime**
- –Ü–º–ø–æ—Ä—Ç—É–π —Ç—ñ–ª—å–∫–∏ `auth`, `cookies`, `NextResponse`
- üî• –Ø–∫—â–æ —Ç—Ä–µ–±–∞ —Ä–æ–ª—ñ ‚Äî –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π `token` –∑ `auth().token.role`

---

## ‚úÖ 5. –í `env`-–∑–º—ñ–Ω–Ω–∏—Ö ‚Äî –ø–∏—à–∏ **–ø–æ–≤–Ω—É –Ω–∞–∑–≤—É –∑–º—ñ–Ω–Ω–æ—ó**
- `GOOGLE_CLIENT_ID`, –∞ –Ω–µ `GOOGLE_ID`
- `GOOGLE_CLIENT_SECRET`, –∞ –Ω–µ `GOOGLE_SECRET`
- –Ü–Ω–∞–∫—à–µ next-auth –Ω–µ –±–∞—á–∏—Ç—å —ó—ó –∞–±–æ –Ω–µ –ø–µ—Ä–µ–¥–∞—î –¥–∞–ª—ñ

---

## ‚úÖ 6. –£–Ω–∏–∫–∞–π `useEffect` –¥–ª—è —Å–µ—Å—ñ–π/—Ä–æ–ª–µ–π
- –ù–∞ —Å–µ—Ä–≤–µ—Ä—ñ —î `auth()` ‚Äî –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π –π–æ–≥–æ
- –ù–µ "–¥–æ–≤–∞–Ω—Ç–∞–∂—É–π" —Å–µ—Å—ñ—é —á–µ—Ä–µ–∑ –∫–ª—ñ—î–Ω—Ç—Å—å–∫—ñ —Ö–∞–∫—ñ

---

## ‚úÖ 7. –ö–æ–∂–Ω–∞ –ª–æ–≥—ñ–∫–∞ –º–∞—î –±—É—Ç–∏ **–≤ –æ–∫—Ä–µ–º–æ–º—É –º—ñ—Å—Ü—ñ**:
| –©–æ?                        | –î–µ?                                |
|---------------------------|-------------------------------------|
| –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è             | `authConfig.js` –∞–±–æ `auth.js`      |
| Server Action              | –æ–∫—Ä–µ–º–∏–π `actions/xyz.js`           |
| API-–æ–±—Ä–æ–±–∫–∞                | —É `route.js` (–≤ API)               |
| –í–∞–ª—ñ–¥–∞—Ü—ñ—è (yup/zod)        | –æ–∫—Ä–µ–º–æ –≤ `lib/validators`          |
| Mongo DB –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è       | `utils/db.js`                      |

---

## ‚úÖ 8. –ü—ñ—Å–ª—è –∑–º—ñ–Ω–∏ `.env.local` ‚Äî –∑–∞–≤–∂–¥–∏:
- –∑–±–µ—Ä–µ–∂–∏ —Ñ–∞–π–ª
- –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ dev-—Å–µ—Ä–≤–µ—Ä
```bash
pnpm dev
```

---

## ‚úÖ 9. `next-auth` –Ω–µ –∑–±–µ—Ä—ñ–≥–∞—î `role` –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ
- –ó–±–µ—Ä—ñ–≥–∞–π —á–µ—Ä–µ–∑ `callbacks.jwt()` —ñ `callbacks.session()`

---

## ‚úÖ 10. –°–µ—Å—ñ—è –∑ `auth()` ‚â† —Å–µ—Å—ñ—è –∑ `useSession()`
| –ú–µ—Ç–æ–¥        | –î–µ –ø—Ä–∞—Ü—é—î        | –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è             |
|--------------|------------------|--------------------------|
| `auth()`     | —Å–µ—Ä–≤–µ—Ä            | –∑–∞—Ö–∏—Å—Ç —Å—Ç–æ—Ä—ñ–Ω–æ–∫, role    |
| `useSession()` | –∫–ª—ñ—î–Ω—Ç           | –ø–æ–∫–∞–∑ –∫–Ω–æ–ø–æ–∫ UI, –º–µ–Ω—é    |

---

## üü° –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è —á–µ—Ä–µ–∑ Google + –î–æ–¥–∞–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ –±–∞–∑—É

### ‚úÖ –î–æ—Å—è–≥–Ω—É—Ç–æ:
- –£—Å–ø—ñ—à–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è —á–µ—Ä–µ–∑ Google (NextAuth v5).
- –ü—ñ—Å–ª—è –≤—Ö–æ–¥—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–±–µ—Ä—ñ–≥–∞—î–º–æ –≤ –±–∞–∑—É MongoDB (—á–µ—Ä–µ–∑ `MongoDBAdapter`).

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞:
- –ü—ñ—Å–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è `MongoDBAdapter` –≤–∏–Ω–∏–∫–ª–∞ –ø–æ–º–∏–ª–∫–∞ `The edge runtime does not support Node.js 'crypto' module`.
- –¶–µ —Å—Ç–∞–ª–æ—Å—è, —Ç–æ–º—É —â–æ `auth()` –∑ `@/auth` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–≤—Å—è –≤ **middleware**, —è–∫–∏–π –ø—Ä–∞—Ü—é—î –≤ **Edge Runtime**. –ê–¥–∞–ø—Ç–µ—Ä `MongoDBAdapter` —Ç—è–≥–Ω–µ `mongodb`, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `crypto`, –Ω–µ—Å—É–º—ñ—Å–Ω–∏–π –∑ Edge.

### ‚úÖ –†—ñ—à–µ–Ω–Ω—è:
- –£ **middleware** –∑–∞–º—ñ–Ω–µ–Ω–æ `auth()` –Ω–∞ `getToken()` –∑ `next-auth/jwt` ‚Äî –≤—ñ–Ω —Å—É–º—ñ—Å–Ω–∏–π –∑ Edge —ñ –¥–æ–∑–≤–æ–ª—è—î –≤–∏—Ç—è–≥—Ç–∏ JWT –±–µ–∑ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó –∞–¥–∞–ø—Ç–µ—Ä–∞.
- `auth()` –∑–∞–ª–∏—à–µ–Ω–æ —Ç—ñ–ª—å–∫–∏ –≤ API Routes —ñ —Å–µ—Ä–≤–µ—Ä–Ω–æ–º—É –∫–æ–¥—ñ (Node.js).

---

> –¶–µ–π –ø—ñ–¥—Ö—ñ–¥ –¥–æ–∑–≤–æ–ª–∏–≤ –∑–±–µ—Ä–µ–≥—Ç–∏ –≥–Ω—É—á–∫—ñ—Å—Ç—å: –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ MongoDBAdapter —ñ –ø—Ä–∏ —Ü—å–æ–º—É —É–Ω–∏–∫–∞—î–º–æ –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—ñ–≤ –∑ Edge Runtime.